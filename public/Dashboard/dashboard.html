<!DOCTYPE html>
<html lang="pt-br">

<head>
  
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3024: Uma Odisséia INBOX | Dashboard</title>


    <link rel="stylesheet" href="../css/dashboards.css">
    <style>
        
        .chart-container {
           
            width: 800px;
            text-align: center;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            height: 500px;
        }
        canvas {
            width: 100% !important;
            height: auto !important;
        }

        .pai{
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            width: calc(100% - 300px);
            height: 100vh;
        }
        
    </style>
</head>
<body>
    <div class="menu">
        <h2>Olá, que legal te ver por aqui!</h2>
        <ul>
            <li><a href="../jogo.html">Jogar Robos VS Humanos</a></li>
            
            <li><a href="../votos.html">Votação</a></li>
            <li><a href="../index.html">Ir para home</a></li>
        </ul>
    </div>
    <div class="pai">
    <h1 style="text-align: center;">Através desse gráfico, saiba quais são os personagens favoritos do público. Clique em "votação" e nos conte qual é o seu personagem preferido!</h1>
    <div class="chart-container">
        <canvas id="myChart"></canvas>
    </div>
</div>

</body>

</html>

<!-- <script src="dash.js"></script> -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>


    obterDadosGrafico()
    function obterDadosGrafico() {
        fetch(`/usuarios/votos`)
            .then(function (resposta) {
                if (resposta.ok) {
                    console.log('aaaaaaaaaaa')
                    resposta.json().then(function (dados) {
                        console.log("Dados recebidos: ", JSON.stringify(dados));
                        dados.reverse();

                        console.log(dados)
                        plotarGrafico_1(dados);
                    });
                } else {
                    console.error('Nenhum dado encontrado da pergunta1 ou erro na API');
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }
    function plotarGrafico_1(dados) {
        console.log("Dados recebidos no plotar: ", JSON.stringify(dados));
        console.log('Iniciando plotagem do gráfico...');
        console.log(dados)
        var votos = [];

        for (var i = 0; i < dados.length; i++) {
            var registo = dados[i]
            votos.push(registo.Option1)
            votos.push(registo.Option2)
            votos.push(registo.Option3)
            votos.push(registo.Option4)
            votos.push(registo.Option5)
            votos.push(registo.Option6)
            votos.push(registo.Option7)

//continuar
        }

        

        const ctx = document.getElementById('myChart');
        var labels = ['Blogueira', 'Narrador', 'Lari Apaixonada', 'Robô Assasino', 'Morita', 'Vovózinha', 'Faxineira' ]; //colocar nome dos 7 personagens
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Quantidade de VOTOS',
                    data: votos,
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)',
                        'rgba(99, 255, 132, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)',
                        'rgba(99, 255, 132, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                },
                
            }
        });
    }
</script>